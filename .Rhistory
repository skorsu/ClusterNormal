test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 100, b0 = 1, mu0 = 0, s20 = 1, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
apply(test_result$sigma2[-c(1:7500), ], 2, mean)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1000, b0 = 1, mu0 = 0, s20 = 1, xi0 = 1,
ci_init = rep(1, 50))
apply(test_result$sigma2[-c(1:7500), ], 2, mean)
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 1, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 10,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 10), ci_true)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 10,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 10), ci_true)
hist(dat)
ggplot(data.frame(x = ci_init, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 10,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 10), ci_true)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
hist(test_result$mu[-c(1:7500), 4])
plot(test_result$sigma2[-c(1:7500), 4], type = "l")
plot(test_result$mu[-c(1:7500), 4], type = "l")
plot(test_result$mu[-c(1:7500), 1], type = "l")
plot(test_result$mu[-c(1:7500), 2], type = "l")
plot(test_result$mu[-c(1:7500), 3], type = "l")
plot(test_result$mu[-c(1:7500), 4], type = "l")
plot(test_result$mu[-c(1:7500), 5], type = "l")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
test_result <- fmm_rcpp(iter = 50000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
table(salso(test_result$assign_mat[-c(1:25000), ], maxNClusters = 5), ci_true)
plot(test_result$sigma2[-c(1:25000), 5], type = "l")
plot(test_result$mu[-c(1:25000), 5], type = "l")
test_result <- fmm_rcpp(iter = 50000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init)
table(salso(test_result$assign_mat[-c(1:25000), ], maxNClusters = 5), ci_true)
apply(test_result$mu[-c(1:25000), ], 2, mean)
apply(test_result$sigma2[-c(1:25000), ], 2, mean)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
test_result <- fmm_rcpp(iter = 50000, y = dat, K_max = 5,
a0 = 2, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init)
apply(test_result$mu[-c(1:25000), ], 2, mean)
apply(test_result$sigma2[-c(1:25000), ], 2, mean)
table(salso(test_result$assign_mat[-c(1:25000), ], maxNClusters = 5), ci_true)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init)
table(salso(test_result$assign_mat[-c(1:25000), ], maxNClusters = 5), ci_true)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:25000), ], maxNClusters = 5), ci_true)
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
plot(test_result$mu[-c(1:25000), 5], type = "l")
plot(test_result$mu[-c(1:7500), 5], type = "l")
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 2)
ci_init <- rep(c(0:4), 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram()
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 10)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20)
test_result <- fmm_rcpp(iter = 10000, y = dat, K_max = 5,
a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50))
table(salso(test_result$assign_mat[-c(1:7500), ], maxNClusters = 5), ci_true)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
data.frame(mu_init, s2_init, alpha_init)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
data.frame(mu_init, s2_init, alpha_init)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
data.frame(mu_init, s2_init, alpha_init)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(1, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true - 1, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true - 1, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
mu_init
s2_init
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true - 1, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true - 1, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(mu_init, s2_init, alpha_init)
ci_true <- rep(1:5, 100)
dat <- rnorm(500, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
ci_true <- rep(1:5, 100)
dat <- rnorm(500, c(0, 7.5, 15, 25, 35)[ci_true], 3)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true - 1, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_true - 1, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0:1, 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 4), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 4), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
test <- SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
test$new_ci
table(ci_true, test$new_ci)
test <- SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
table(ci_true, test$new_ci)
test <- SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
table(ci_true, test$new_ci)
Rcpp::sourceCpp("src/main.cpp")
Rcpp::sourceCpp("src/main.cpp")
Rcpp::sourceCpp("src/main.cpp")
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
test <- SFDMM_realloc(dat, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
table(ci_true, test$new_ci)
test$new_mu
test$new_s2
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
test$new_mu
test$new_s2
data.frame(mu_init, s2_init, alpha_init)
table(ci_true, test$new_ci)
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(mu_init, s2_init, alpha_init)
data.frame(test$new_mu, test$new_s2)
mean(dat)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
Rcpp::sourceCpp("src/main.cpp")
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
Rcpp::sourceCpp("src/main.cpp")
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(test$new_mu, test$new_s2, test$new_alpha)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(0, 50), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(test$new_mu, test$new_s2, test$new_alpha)
data.frame(mu_init, s2_init, alpha_init)
mean(dat)
var(dat)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
data.frame(mu_init, s2_init, alpha_init)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(1, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(test$new_mu, test$new_s2, test$new_alpha)
table(ci_true, test$new_ci)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
data.frame(mu_init, s2_init, alpha_init)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(0, 2), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(test$new_mu, test$new_s2, test$new_alpha)
table(ci_true, test$new_ci)
mu_init
data.frame(mu_init, s2_init, alpha_init)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(0:4), 10)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- rgamma(5, 1, 1)
data.frame(mu_init, s2_init, alpha_init)
ggplot(data.frame(x = ci_true, y = dat), aes(x = y, fill = factor(x))) +
geom_histogram(bins = 20) +
theme_bw()
test <- SFDMM_realloc(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init)
data.frame(test$new_mu, test$new_s2, test$new_alpha)
table(ci_true, test$new_ci)
Rcpp::sourceCpp("src/main.cpp")
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
sp <- rep(NA, 1000){
sp <- rep(NA, 1000)
for(i in 1:1000){
sp[i] <- SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)$split_ind
}
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)$split_ind
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)$split_ind
Rcpp::sourceCpp("src/main.cpp")
sp <- rep(NA, 1000)
for(i in 1:1000){
sp[i] <- SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)$split_ind
}
Rcpp::sourceCpp("src/main.cpp")
sp <- rep(NA, 1000)
for(i in 1:1000){
sp[i] <- SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)$split_ind
}
Rcpp::sourceCpp("src/main.cpp")
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = rep(c(2, 3), 25), mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
Rcpp::sourceCpp("src/main.cpp")
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
sp <- rep(NA, 1000)
for(i in 1:1000){
sp[i] <- SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)$split_ind
}
mean(sp)
table(sp)
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(2, 3), 25)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- c(0, 0, rgamma(2, 1, 1), 0)
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
Rcpp::sourceCpp("src/main.cpp")
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(2, 3), 25)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- c(0, 0, rgamma(2, 1, 1), 0)
data.frame(mu_init, s2_init, alpha_init)
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_vec = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_init = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
data.frame(mu_init, s2_init, alpha_init)
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_init = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
data.frame(mu_init, s2_init, alpha_init)
Rcpp::sourceCpp("src/main.cpp")
set.seed(31807)
ci_true <- rep(1:5, 10)
dat <- rnorm(50, c(0, 7.5, 15, 25, 35)[ci_true], 1)
ci_init <- rep(c(2, 3), 25)
mu_init <- rnorm(5, 0, sqrt(100))
s2_init <- 1/rgamma(5, 1, 1)
alpha_init <- c(0, 0, rgamma(2, 1, 1), 0)
data.frame(mu_init, s2_init, alpha_init)
SFDMM_SM(dat, K_max = 5, a0 = 1, b0 = 1, mu0 = 0, s20 = 100, xi0 = 1,
ci_init = ci_init, mu = mu_init, s2 = s2_init,
alpha_init = alpha_init, launch_iter = 10, a_theta = 1, b_theta = 1)
