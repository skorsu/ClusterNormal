xi_vec <- rep(0.01, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(10, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
start_time <- Sys.time()
result <- our_model(1000, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result$iter_assign[-(1:500), ]))
### Setting 2
K <- 10
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(10, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
start_time <- Sys.time()
result <- our_model(1000, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result$iter_assign[-(1:500), ]))
### Setting 2
K <- 10
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
a_theta <- 1
b_theta <- 4
sm_iter <- 10
start_time <- Sys.time()
result <- our_model(1000, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result$iter_assign[-(1:500), ]))
result$iter_assign
result$iter_assign
n_unique <- function(vec){
length(unique(vec))
}
## Data Simulation
rm(list = ls())
seed_val <- 2
### Setting 1
set.seed(seed_val)
ci_actual_1 <- sample(1:2, 500, replace = TRUE)
data_sim_1 <- rnorm(500, c(-5, 5)[ci_actual_1], 1)
### Setting 2
set.seed(seed_val)
ci_actual_2 <- sample(1:5, 500, replace = TRUE)
data_sim_2 <- rnorm(500, c(-100, -50, -20, 50, 100)[ci_actual_2], 1)
### Setting 3
set.seed(seed_val)
ci_actual_3 <- sample(1:2, 500, replace = TRUE)
data_sim_3 <- rnorm(500, c(-5, 5)[ci_actual_3], 4)
### Setting 4
set.seed(seed_val)
ci_actual_4 <- sample(1:5, 500, replace = TRUE)
data_sim_4 <- rnorm(500, c(-10, -5, 0, 20, 40)[ci_actual_4],
c(1.5, 1.5, 1.5, 3, 3)[ci_actual_4])
### Setting 1
K <- 10
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result1 <- our_model(1000, K, ci_init, xi_vec, scale(data_sim_1), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_1, salso(result1$iter_assign[-(1:500), ]))
result1
?salso()
table(ci_actual_1, salso(result1$iter_assign[-(1:500), ], maxNClusters = K))
table(ci_actual_1, salso(result1$iter_assign[-(1:500), ], maxNClusters = 5000))
apply(result1, 1, n_unique)
n_unique <- function(vec){
length(unique(vec))
}
apply(result1, 1, n_unique)
apply(result1, 2, n_unique)
apply(result1$iter_assign, 1, n_unique)
plot(apply(result1$iter_assign, 1, n_unique))
plot(1:1000, apply(result1$iter_assign, 1, n_unique), type = "l", ylim = c(1, 5))
### Setting 1
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result1 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_1), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_1, salso(result1$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result1$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 2
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result2 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result2$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result2$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 2
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(0.01, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result2 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result2$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result2$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 2
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result2 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result2$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result2$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 2
K <- 10
iter <- 2000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result2 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_2), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_2, salso(result2$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result2$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 3
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result3 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_3), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_3, salso(result3$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result1$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
table(ci_actual_3, salso(result3$iter_assign[-(1:750), ], maxNClusters = K))
### Setting 3
K <- 10
iter <- 2000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result3 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_3), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_3, salso(result3$iter_assign[-(1:1000), ], maxNClusters = K))
plot(1:iter, apply(result1$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
plot(1:iter, apply(result3$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 3
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(10, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result3 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_3), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_3, salso(result3$iter_assign[-(1:1000), ], maxNClusters = K))
plot(1:iter, apply(result3$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
ci_actual_3
table(ci_actual_3, salso(result3$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result3$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
table(ci_actual_3, salso(result3$iter_assign[-(1:750), ], maxNClusters = K))
table(ci_actual_3, salso(result3$iter_assign[-(1:50), ], maxNClusters = K))
table(ci_actual_3, salso(result3$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result3$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 3
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(10, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 2
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result3 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_3), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_3, salso(result3$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result3$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 4
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(10, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.1, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result4 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_4), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_4, salso(result4$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result4$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 4
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.01, K)
a_theta <- 1
b_theta <- 5
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result4 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_4), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_4, salso(result4$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result4$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 4
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.01, K)
a_theta <- 1
b_theta <- 50
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result4 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_4), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_4, salso(result4$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result4$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 4
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(0.01, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.01, K)
a_theta <- 1
b_theta <- 50
sm_iter <- 10
set.seed(seed_val)
start_time <- Sys.time()
result4 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_4), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_4, salso(result4$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result4$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
### Setting 4
K <- 10
iter <- 1000
ci_init <- rep(1, 500)
xi_vec <- rep(0.01, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(100, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(0.01, K)
a_theta <- 1
b_theta <- 1
sm_iter <- 25
set.seed(seed_val)
start_time <- Sys.time()
result4 <- our_model(iter, K, ci_init, xi_vec, scale(data_sim_4), mu0_vec,
a_sigma_vec, b_sigma_vec, lambda_vec, a_theta, b_theta,
sm_iter)
Sys.time() - start_time
table(ci_actual_4, salso(result4$iter_assign[-(1:500), ], maxNClusters = K))
plot(1:iter, apply(result4$iter_assign, 1, n_unique), type = "l",
ylim = c(1, K), xlab = "Iteration", ylab = "Active Cluster")
read.csv("/Users/kevinkvp/Desktop/exam2.csv")
dat <- read.csv("/Users/kevinkvp/Desktop/exam2.csv")
library(tidyverse)
head()∂at
head(dat)
colnames(dat)
colnames(dat)[c(2, 4)]
colnames(dat)[c(2, 4)] <- C("Name", "Time")
colnames(dat)[c(2, 4)] <- c("Name", "Time")
dat
dat %>%
filter(Section == "301-008")
dat %>%
filter(Section == "301-008") %>%
distinct(Name)
dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name)
dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name) %>%
scan(, what = "")
dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name) %>%
scan(what = "")
dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name) %>%
strsplit(" +")[[1]]
dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name) %>%
strsplit(" ")[[1]]
name_stu <- dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name)
apply(name_stu, 2, strsplit)
?strsplit
apply(name_stu, 2, strsplit, split = "+")
apply(name_stu, 2, strsplit, split = " +")
cbind(apply(name_stu, 2, strsplit, split = " +"))
name_list <- apply(name_stu, 2, strsplit, split = " +")
name_list
name_list$Name
name_list$Name[[1]]
name_list$Name[[1]][2]
dim(dat)
dim(name_stu)
data.frmae(matrix(NA, ncol = 2, nrow = dim(name_stu)[1]))
data.frame(matrix(NA, ncol = 2, nrow = dim(name_stu)[1]))
dat_new <- data.frame(matrix(NA, ncol = 2, nrow = dim(name_stu)[1]))
for(i in name_list){
print(i)
}
for(i in 1:dim(name_stu)[1]){
i
}
for(i in 1:dim(name_stu)[1]){
print(i)
}
for(i in 1:dim(name_stu)[1]){
print(name_list[[i]])
}
dim(name_stu)[1]
for(i in 1:dim(name_stu)[1]){
print(name_list[[i]])
}
for(i in 1:dim(name_stu)[1]){
name_list$Name[[i]]
}
dat_new <- data.frame(matrix(NA, ncol = 2, nrow = dim(name_stu)[1]))
for(i in 1:dim(name_stu)[1]){
dat_new[i, 1] <- name_list$Name[[i]][1]
dat_new[i, 2] <- name_list$Name[[i]][2]
}
dat_new
dat_new %>%
select(X2, X1)
dat_new %>%
select(X2, X1) %>%
arrange(X2)
dat
dat %>%
filter(Name == "Kevin")
library(tidyverse)
dat <- read.csv("/Users/kevinkvp/Desktop/exam2.csv")
colnames(dat)[c(2, 4)] <- c("Name", "Time")
name_stu <- dat %>%
filter(Section == "301-008") %>%
distinct(Name) %>%
arrange(Name)
name_stu <- dat %>%
filter(Section == "301-008")
name_stu$Time
table(name_stu$Time)
