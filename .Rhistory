library(devtools)
library(LaplacesDemon)
library(mvtnorm)
library(DirichletReg)
library(salso)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
rm(list = ls())
set.seed(31807)
ci <- sample(1:5, 100, TRUE)
a_sigma <- (2:6)/2
b_sigma <- (6:2)/2
sigma2_vec <- rinvgamma(5, a_sigma, 1/b_sigma)
lambda_vec <- (1:5)/100
mu0_vec <- c(10, 30, 50, 70, 90)
data_test <- rep(NA, 100)
ci_test <- rep(1:4, 25)
xi <- rep(5, 5)
alpha_test <- c(10, 10, 10, 10, 0)
for(i in 1:100){
data_test[i] <- rnorm(1, mu0_vec[ci[i]],
sqrt(sigma2_vec[ci[i]]/lambda_vec[ci[i]]))
}
table(ci)
uni_alloc(1, ci, xi, data_test, a_sigma, b_sigma, lambda_vec, mu0_vec)
ci
unique(ci)
uni_alloc(1, ci, xi, data_test, a_sigma, b_sigma, lambda_vec, mu0_vec, unique(ci))
uni_alloc(1, ci, xi, data_test, a_sigma, b_sigma, lambda_vec, mu0_vec, unique(ci))
for(i in 0:99){
uni_alloc(i, ci, xi, data_test, a_sigma, b_sigma, lambda_vec, mu0_vec, unique(ci))
}
for(i in 0:99){
print(uni_alloc(i, ci, xi, data_test, a_sigma, b_sigma, lambda_vec, mu0_vec, unique(ci)))
}
cluster_assign_univariate(5, sort(rep(1:4, 25)), xi, data_test, alpha_test,
mu0_vec, a_sigma, b_sigma, lambda_vec)
sort(rep(1:4, 25))
cluster_assign_univariate(5, sort(rep(1:5, 20)), xi, data_test, alpha_test,
mu0_vec, a_sigma, b_sigma, lambda_vec)
alpha_test <- c(10, 10, 10, 10, 10)
cluster_assign_univariate(5, sort(rep(1:5, 20)), xi, data_test, alpha_test,
mu0_vec, a_sigma, b_sigma, lambda_vec)
cluster_assign_univariate(5, sort(rep(1:4, 25)), xi, data_test, alpha_test,
mu0_vec, a_sigma, b_sigma, lambda_vec)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
alpha_test <- c(10, 10, 10, 10, 0)
split_merge_univariate(5, sort(rep(1:4, 25)), alpha_test,
xi, data_test, mu0_vec, a_sigma, b_sigma, lambda_vec, 10 , 10, 10)
split_merge_univariate(5, sort(rep(1:4, 25)), alpha_test,
xi, data_test, mu0_vec, a_sigma, b_sigma, lambda_vec, 10 , 10, 10)
split_merge_univariate(5, sort(rep(1:4, 25)), alpha_test,
xi, data_test, mu0_vec, a_sigma, b_sigma, lambda_vec, 10 , 10, 10)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
split_merge_univariate(5, sort(rep(1:4, 25)), alpha_test,
xi, data_test, mu0_vec, a_sigma, b_sigma, lambda_vec, 10 , 10, 10)
for(i in 1:10000){
split_merge_univariate(5, sort(rep(1:4, 25)), alpha_test,
xi, data_test, mu0_vec, a_sigma, b_sigma, lambda_vec, 10 , 10, 10)
}
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
knitr::opts_chunk$set(echo = TRUE)
library(Rcpp)
library(RcppArmadillo)
library(devtools)
library(LaplacesDemon)
library(salso)
library(tidyverse)
library(ggplot2)
library(mvtnorm)
library(ClusterNormal)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, -5, 1), rnorm(75, 10, 1))
data.frame(x = data_test, y = c(rep(1, 50), rep(2, 75))) %>%
ggplot(aes(x = x, fill = factor(y))) +
geom_histogram(bins = 30) +
theme_bw()
## Analysis
K <- 5
K_init <- 3
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 5000, 1000)
Sys.time() - start_time
table(factor(c(rep(1, 50), rep(2, 75))), summary(salso(result[2001:5000, ]))$estimate)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, -5, 1), rnorm(75, 10, 1))
data.frame(x = data_test, y = c(rep(1, 50), rep(2, 75))) %>%
ggplot(aes(x = x, fill = factor(y))) +
geom_histogram(bins = 30) +
theme_bw()
## Analysis
K <- 5
K_init <- 3
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
table(factor(c(rep(1, 50), rep(2, 75))), summary(salso(result[2001:5000, ]))$estimate)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(100, -10, 4), rnorm(100, 0, 1), rnorm(100, 15, 10))
ci_actual <- factor(sort(rep(1:3, 100)))
data.frame(x = data_test, ci_actual) %>%
ggplot(aes(x = x, fill = ci_actual)) +
geom_histogram(bins = 30, alpha = 0.75) +
theme_bw()
## Analysis
K <- 7
K_init <- 2
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 5000, 500)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(100, 25, 4), rnorm(100, 30, 1), rnorm(100, 35, 10))
ci_actual <- factor(sort(rep(1:3, 100)))
data.frame(x = data_test, ci_actual) %>%
ggplot(aes(x = x, fill = ci_actual)) +
geom_histogram(bins = 30, alpha = 0.75) +
theme_bw()
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, 25, 4), rnorm(50, 30, 1), rnorm(50, 35, 10))
ci_actual <- factor(sort(rep(1:3, 50)))
data.frame(x = data_test, ci_actual) %>%
ggplot(aes(x = x, fill = ci_actual)) +
geom_histogram(bins = 30, alpha = 0.75) +
theme_bw()
## Analysis
K <- 7
K_init <- 2
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 500)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, 25, 4), rnorm(50, 30, 1), rnorm(50, 35, 10))
ci_actual <- factor(sort(rep(1:3, 50)))
data.frame(x = data_test, ci_actual) %>%
ggplot(aes(x = x, fill = ci_actual)) +
geom_histogram(bins = 30, alpha = 0.75) +
theme_bw()
## Analysis
K <- 7
K_init <- 2
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, 25, 4), rnorm(50, 30, 1), rnorm(50, 35, 10))
ci_actual <- factor(sort(rep(1:3, 50)))
data.frame(x = data_test, ci_actual) %>%
ggplot(aes(x = x, fill = ci_actual)) +
geom_histogram(bins = 30, alpha = 0.75) +
theme_bw()
## Analysis
K <- 7
K_init <- 15
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, -5, 1), rnorm(75, 10, 1))
data.frame(x = data_test, y = c(rep(1, 50), rep(2, 75))) %>%
ggplot(aes(x = x, fill = factor(y))) +
geom_histogram(bins = 30) +
theme_bw()
## Analysis
K <- 5
K_init <- 3
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
table(factor(c(rep(1, 50), rep(2, 75))), summary(salso(result[2001:5000, ]))$estimate)
K <- 5
K_init <- 3
xi <- rep(1, 2)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
## Analysis
K <- 5
K_init <- 3
xi <- rep(1, 10)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
rm(list = ls())
## Data Simulation
set.seed(20882)
data_test <- c(rnorm(50, -5, 1), rnorm(75, 10, 1))
data.frame(x = data_test, y = c(rep(1, 50), rep(2, 75))) %>%
ggplot(aes(x = x, fill = factor(y))) +
geom_histogram(bins = 30) +
theme_bw()
## Analysis
K <- 5
K_init <- 3
xi <- rep(1, K)
mu0_vec <- rep(0, K)
a_sigma_vec <- rep(1, K)
b_sigma_vec <- rep(1, K)
lambda_vec <- rep(1, K)
start_time <- Sys.time()
result <- normal_uni(K, K_init, data_test, xi, mu0_vec, a_sigma_vec,
b_sigma_vec, lambda_vec, 10, 10, 10, 10000, 1000)
Sys.time() - start_time
table(factor(c(rep(1, 50), rep(2, 75))), summary(salso(result[2001:5000, ]))$estimate)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
#### Multivariate
rm(list = ls())
set.seed(31807)
data_test <- rbind(rmvnorm(100, c(3, 3)), rmvnorm(100, c(-3, -3)))
plot(data_test)
K <- 5
mu_0_vec <- matrix(1:K, K, 2)
lambda_0_vec <- rep(0.01, K)
nu_0_vec <- rep(50, K)
L_array <- replicate(5, diag(2))
xi_test <- rep(1, 5)
expand_step_multi(K, rep(1, 100), rep(2, 5), rep(1, 5), data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10)
expand_step_multi(K, rep(1, 100), rep(2, 5), rep(1, 5), data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
multi_alloc(0, rep(1, 100), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1))
multi_alloc(0, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
multi_alloc(0, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
multi_alloc(0, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
multi_alloc(0, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
multi_alloc(0, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
multi_alloc(0, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
multi_alloc(i, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
for(i in 0:99){
multi_alloc(i, rep(1:2, 50), xi_test, data_test, mu_0_vec, lambda_0_vec, nu_0_vec,
L_array, c(1, 2))
}
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
compileAttributes()
build()
install()
library(ClusterNormal)
alpha_test <- rep(1, 5)
multi_cluster_assign(5, rep(1:2, 50), xi_test, data_test, alpha_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array)
multi_cluster_assign(5, rep(1:2, 50), xi_test, data_test, alpha_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
split_merge_multi(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
split_merge_multi(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
split_merge_multi(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
### Required Commands for build the packages: ----------------------------------
uninstall()
compileAttributes()
build()
install()
library(ClusterNormal)
split_merge_multi(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
multi_split_merge(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
multi_split_merge(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
for(i in 1:10000){
multi_split_merge(5, rep(1:2, 50), c(1, 1, 0, 0, 0), xi_test, data_test, mu_0_vec,
lambda_0_vec, nu_0_vec, L_array, 10, 10, 10)
}
rm(list = ls())
set.seed(31807)
data_test <- rbind(rmvnorm(50, c(0, 0, 0)),
rmvnorm(50, c(0, 5, 0)),
rmvnorm(50, c(5, 5, 5)))
ci_actual <- factor(sort(rep(1:3, 50)))
### Analysis
set.seed(31807)
K <- 10
xi <- rep(10, K)
mu_0 <- matrix(0, K, 3)
lambda_0 <- rep(10, K)
nu_0 <- rep(1, K)
L_0 <- replicate(K, diag(3))
result <- normal_multi(K, K, data_test, xi, mu_0, lambda_0, nu_0, L_0,
1, 1, 10, 5000, 1000)
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
result
rm(list = ls())
set.seed(31807)
data_test <- rbind(rmvnorm(50, c(0, 0, 0)),
rmvnorm(50, c(0, 5, 0)),
rmvnorm(50, c(5, 5, 5)))
ci_actual <- factor(sort(rep(1:3, 50)))
rm(list = ls())
set.seed(31807)
data_test <- rbind(rmvnorm(50, c(0, 0, 0)),
rmvnorm(50, c(0, 5, 0)),
rmvnorm(50, c(5, 5, 5)))
ci_actual <- factor(sort(rep(1:3, 50)))
### Analysis
set.seed(31807)
K <- 10
xi <- rep(10, K)
mu_0 <- matrix(0, K, 3)
lambda_0 <- rep(10, K)
nu_0 <- rep(1, K)
L_0 <- replicate(K, diag(3))
start_time <- Sys.time()
result <- normal_multi(K, K, data_test, xi, mu_0, lambda_0, nu_0, L_0,
1, 1, 10, 10000, 1000)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
rm(list = ls())
set.seed(31807)
data_test <- rbind(rmvnorm(100, c(-5, 0), matrix(c(5, 2, 2, 5), 2, 2)),
rmvnorm(100, c(0, 5), matrix(c(1, 0.5, 0.5, 1), 2, 2)),
rmvnorm(100, c(5, 5), matrix(c(4, 3, 3, 3), 2, 2)))
ci_actual <- factor(sort(rep(1:3, 100)))
data.frame(data_test, ci_actual) %>%
ggplot(aes(x = X1, y = X2, color = ci_actual)) +
geom_point() +
theme_bw()
### Analysis
set.seed(31807)
K <- 7
xi <- rep(10, K)
mu_0 <- matrix(0, K, 2)
lambda_0 <- rep(0.01, K)
nu_0 <- rep(1, K)
L_0 <- replicate(K, diag(2))
start_time <- Sys.time()
result <- normal_multi(K, K, data_test, xi, mu_0, lambda_0, nu_0, L_0,
1, 1, 10, 10000, 1000)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:5000, ]))$estimate)
table(ci_actual, summary(salso(result[2001:10000, ]))$estimate)
rm(list = ls())
set.seed(31807)
data_test <- rbind(rmvnorm(100, c(-5, 0), matrix(c(5, 2, 2, 5), 2, 2)),
rmvnorm(100, c(0, 5), matrix(c(1, 0.5, 0.5, 1), 2, 2)),
rmvnorm(100, c(5, 5), matrix(c(4, 3, 3, 3), 2, 2)))
ci_actual <- factor(sort(rep(1:3, 100)))
data.frame(data_test, ci_actual) %>%
ggplot(aes(x = X1, y = X2, color = ci_actual)) +
geom_point() +
theme_bw()
### Analysis
set.seed(31807)
K <- 7
xi <- rep(10, K)
mu_0 <- matrix(0, K, 2)
lambda_0 <- rep(0.01, K)
nu_0 <- rep(1, K)
L_0 <- replicate(K, 5 * diag(2))
start_time <- Sys.time()
result <- normal_multi(K, K, data_test, xi, mu_0, lambda_0, nu_0, L_0,
1, 1, 10, 10000, 1000)
Sys.time() - start_time
table(ci_actual, summary(salso(result[2001:10000, ]))$estimate)
